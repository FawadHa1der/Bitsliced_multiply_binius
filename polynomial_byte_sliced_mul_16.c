#include <stdio.h>
#include <assert.h>
#include <stdint.h>
#include "bs.h"
#include "polynomial_byte_sliced_mul_16.h"
void byte_slice_mul_128(uint64_t x[16], uint64_t y[16], uint64_t* z);

uint8_t multiply_8b_using_log_table(
    uint8_t lhs, uint8_t rhs,
    const uint8_t log_table[256],
    const uint8_t exp_table[256]
);

// Wrapper function for uint64_t inputs
uint64_t multiply_64b_using_log_table(
    uint64_t *lhs, uint64_t *rhs, uint64_t* result) {

    uint8_t *lhs_bytes = (uint8_t *)lhs;
    uint8_t *rhs_bytes = (uint8_t *)rhs;
    uint8_t *result_bytes = (uint8_t *)result;
const uint8_t EXP_TABLE[256] = {
    0x1,  0x13, 0x43, 0x66, 0xab, 0x8c, 0x60, 0xc6, 0x91, 0xca, 0x59, 0xb2, 0x6a, 0x63, 0xf4, 0x53,
    0x17, 0x0f, 0xfa, 0xba, 0xee, 0x87, 0xd6, 0xe0, 0x6e, 0x2f, 0x68, 0x42, 0x75, 0xe8, 0xea, 0xcb,
    0x4a, 0xf1, 0x0c, 0xc8, 0x78, 0x33, 0xd1, 0x9e, 0x30, 0xe3, 0x5c, 0xed, 0xb5, 0x14, 0x3d, 0x38,
    0x67, 0xb8, 0xcf, 0x06, 0x6d, 0x1d, 0xaa, 0x9f, 0x23, 0xa0, 0x3a, 0x46, 0x39, 0x74, 0xfb, 0xa9,
    0xad, 0xe1, 0x7d, 0x6c, 0x0e, 0xe9, 0xf9, 0x88, 0x2c, 0x5a, 0x80, 0xa8, 0xbe, 0xa2, 0x1b, 0xc7,
    0x82, 0x89, 0x3f, 0x19, 0xe6, 0x03, 0x32, 0xc2, 0xdd, 0x56, 0x48, 0xd0, 0x8d, 0x73, 0x85, 0xf7,
    0x61, 0xd5, 0xd2, 0xac, 0xf2, 0x3e, 0x0a, 0xa5, 0x65, 0x99, 0x4e, 0xbd, 0x90, 0xd9, 0x1a, 0xd4,
    0xc1, 0xef, 0x94, 0x95, 0x86, 0xc5, 0xa3, 0x08, 0x84, 0xe4, 0x22, 0xb3, 0x79, 0x20, 0x92, 0xf8,
    0x9b, 0x6f, 0x3c, 0x2b, 0x24, 0xde, 0x64, 0x8a, 0xd,  0xdb, 0x3b, 0x55, 0x7a, 0x12, 0x50, 0x25,
    0xcd, 0x27, 0xec, 0xa6, 0x57, 0x5b, 0x93, 0xeb, 0xd8, 0x09, 0x97, 0xa7, 0x44, 0x18, 0xf5, 0x40,
    0x54, 0x69, 0x51, 0x36, 0x8e, 0x41, 0x47, 0x2a, 0x37, 0x9d, 0x02, 0x21, 0x81, 0xbb, 0xfd, 0xc4,
    0xb0, 0x4b, 0xe2, 0x4f, 0xae, 0xd3, 0xbf, 0xb1, 0x58, 0xa1, 0x29, 0x05, 0x5f, 0xdf, 0x77, 0xc9,
    0x6b, 0x70, 0xb7, 0x35, 0xbc, 0x83, 0x9a, 0x7c, 0x7f, 0x4d, 0x8f, 0x52, 0x04, 0x4c, 0x9c, 0x11,
    0x62, 0xe7, 0x10, 0x71, 0xa4, 0x76, 0xda, 0x28, 0x16, 0x1c, 0xb9, 0xdc, 0x45, 0x0b, 0xb6, 0x26,
    0xff, 0xe5, 0x31, 0xf0, 0x1f, 0x8b, 0x1e, 0x98, 0x5d, 0xfe, 0xf6, 0x72, 0x96, 0xb4, 0x07, 0x7e,
    0x5e, 0xcc, 0x34, 0xaf, 0xc0, 0xfc, 0xd7, 0xf3, 0x2d, 0x49, 0xc3, 0xce, 0x15, 0x2e, 0x7b, 0x00,
};

const uint8_t LOG_TABLE[256] = {
    0x00, 0x00, 0xaa, 0x55, 0xcc, 0xbb, 0x33, 0xee, 0x77, 0x99, 0x66, 0xdd, 0x22, 0x88, 0x44, 0x11,
    0xd2, 0xcf, 0x8d, 0x01, 0x2d, 0xfc, 0xd8, 0x10, 0x9d, 0x53, 0x6e, 0x4e, 0xd9, 0x35, 0xe6, 0xe4,
    0x7d, 0xab, 0x7a, 0x38, 0x84, 0x8f, 0xdf, 0x91, 0xd7, 0xba, 0xa7, 0x83, 0x48, 0xf8, 0xfd, 0x19,
    0x28, 0xe2, 0x56, 0x25, 0xf2, 0xc3, 0xa3, 0xa8, 0x2f, 0x3c, 0x3a, 0x8a, 0x82, 0x2e, 0x65, 0x52,
    0x9f, 0xa5, 0x1b, 0x02, 0x9c, 0xdc, 0x3b, 0xa6, 0x5a, 0xf9, 0x20, 0xb1, 0xcd, 0xc9, 0x6a, 0xb3,
    0x8e, 0xa2, 0xcb, 0x0f, 0xa0, 0x8b, 0x59, 0x94, 0xb8, 0x0a, 0x49, 0x95, 0x2a, 0xe8, 0xf0, 0xbc,
    0x06, 0x60, 0xd0, 0x0d, 0x86, 0x68, 0x03, 0x30, 0x1a, 0xa1, 0x0c, 0xc0, 0x43, 0x34, 0x18, 0x81,
    0xc1, 0xd3, 0xeb, 0x5d, 0x3d, 0x1c, 0xd5, 0xbe, 0x24, 0x7c, 0x8c, 0xfe, 0xc7, 0x42, 0xef, 0xc8,
    0x4a, 0xac, 0x50, 0xc5, 0x78, 0x5e, 0x74, 0x15, 0x47, 0x51, 0x87, 0xe5, 0x05, 0x5c, 0xa4, 0xca,
    0x6c, 0x08, 0x7e, 0x96, 0x72, 0x73, 0xec, 0x9a, 0xe7, 0x69, 0xc6, 0x80, 0xce, 0xa9, 0x27, 0x37,
    0x39, 0xb9, 0x4d, 0x76, 0xd4, 0x67, 0x93, 0x9b, 0x4b, 0x3f, 0x36, 0x04, 0x63, 0x40, 0xb4, 0xf3,
    0xb0, 0xb7, 0x0b, 0x7b, 0xed, 0x2c, 0xde, 0xc2, 0x31, 0xda, 0x13, 0xad, 0xc4, 0x6b, 0x4c, 0xb6,
    0xf4, 0x70, 0x57, 0xfa, 0xaf, 0x75, 0x07, 0x4f, 0x23, 0xbf, 0x09, 0x1f, 0xf1, 0x90, 0xfb, 0x32,
    0x5b, 0x26, 0x62, 0xb5, 0x6f, 0x61, 0x16, 0xf6, 0x98, 0x6d, 0xd6, 0x89, 0xdb, 0x58, 0x85, 0xbd,
    0x17, 0x41, 0xb2, 0x29, 0x79, 0xe1, 0x54, 0xd1, 0x1d, 0x45, 0x1e, 0x97, 0x92, 0x2b, 0x14, 0x71,
    0xe3, 0x21, 0x64, 0xf7, 0x0e, 0x9e, 0xea, 0x5f, 0x7f, 0x46, 0x12, 0x3e, 0xf5, 0xae, 0xe9, 0xe0,
};
    
    // Loop through each byte of lhs and rhs
    for (int i = 0; i < 8; i++) {
        // Extract each byte using bit shifting and masking
        
        // Multiply the bytes using the multiply_8b_using_log_table function
        result_bytes[i] = multiply_8b_using_log_table(lhs_bytes[i], rhs_bytes[i], LOG_TABLE, EXP_TABLE);
        
        // // Combine the result back into a uint64_t
        // result_bytes |= ((uint64_t)byte_result << (i * 8));
    }

}

uint8_t multiply_8b_using_log_table(
    uint8_t lhs, uint8_t rhs,
    const uint8_t log_table[256],
    const uint8_t exp_table[256]
) {
    uint8_t result = 0;
    
    if (lhs != 0 && rhs != 0) {
        size_t log_table_index = log_table[lhs] + log_table[rhs];

        if (log_table_index > 254) {
            log_table_index -= 255;
        }

        result = exp_table[log_table_index];
    }

    return result;
}
void byte_slice_transpose_mul_128(uint128_t x[8], uint128_t y[8], uint128_t* z){
    uint64_t x_transposed[16];
    uint64_t y_transposed[16];
    uint64_t z_transposed[16];
    
    byte_slice(x, x_transposed);
    byte_slice(y, y_transposed);

    byte_slice_mul_128((uint64_t*)x_transposed, (uint64_t*)y_transposed, (uint64_t*)z_transposed);
    un_byte_slice(z_transposed, z);

}

void byte_slice_mul_128(uint64_t x[16], uint64_t y[16], uint64_t* z)
{
  uint64_t n33;
  uint64_t n34;
  uint64_t n35;
  uint64_t n36;
  uint64_t n37;
  uint64_t n38;
  uint64_t n39;
  uint64_t n40;
  uint64_t n41;
  uint64_t n42;
  uint64_t n43;
  uint64_t n44;
  uint64_t n45;
  uint64_t n46;
  uint64_t n47;
  uint64_t n48;
  uint64_t n49;
  uint64_t n50;
  uint64_t n51;
  uint64_t n52;
  uint64_t n53;
  uint64_t n54;
  uint64_t n55;
  uint64_t n56;
  uint64_t n57;
  uint64_t n58;
  uint64_t n59;
  uint64_t n60;
  uint64_t n61;
  uint64_t n62;
  uint64_t n63;
  uint64_t n64;
  uint64_t n65;
  uint64_t n66;
  uint64_t n67;
  uint64_t n68;
  uint64_t n69;
  uint64_t n70;
  uint64_t n71;
  uint64_t n72;
  uint64_t n73;
  uint64_t n74;
  uint64_t n75;
  uint64_t n76;
  uint64_t n77;
  uint64_t n78;
  uint64_t n79;
  uint64_t n80;
  uint64_t n81;
  uint64_t n82;
  uint64_t n83;
  uint64_t n84;
  uint64_t n85;
  uint64_t n86;
  uint64_t n87;
  uint64_t n88;
  uint64_t n89;
  uint64_t n90;
  uint64_t n91;
  uint64_t n92;
  uint64_t n93;
  uint64_t n94;
  uint64_t n95;
  uint64_t n96;
  uint64_t n97;
  uint64_t n98;
  uint64_t n99;
  uint64_t n100;
  uint64_t n101;
  uint64_t n102;
  uint64_t n103;
  uint64_t n104;
  uint64_t n105;
  uint64_t n106;
  uint64_t n107;
  uint64_t n108;
  uint64_t n109;
  uint64_t n110;
  uint64_t n111;
  uint64_t n112;
  uint64_t n113;
  uint64_t n114;
  uint64_t n115;
  uint64_t n116;
  uint64_t n117;
  uint64_t n118;
  uint64_t n119;
  uint64_t n120;
  uint64_t n121;
  uint64_t n122;
  uint64_t n123;
  uint64_t n124;
  uint64_t n125;
  uint64_t n126;
  uint64_t n127;
  uint64_t n128;
  uint64_t n129;
  uint64_t n130;
  uint64_t n131;
  uint64_t n132;
  uint64_t n133;
  uint64_t n134;
  uint64_t n135;
  uint64_t n136;
  uint64_t n137;
  uint64_t n138;
  uint64_t n139;
  uint64_t n140;
  uint64_t n141;
  uint64_t n142;
  uint64_t n143;
  uint64_t n144;
  uint64_t n145;
  uint64_t n146;
  uint64_t n147;
  uint64_t n148;
  uint64_t n149;
  uint64_t n150;
  uint64_t n151;
  uint64_t n152;
  uint64_t n153;
  uint64_t n154;
  uint64_t n155;
  uint64_t n156;
  uint64_t n157;
  uint64_t n158;
  uint64_t n159;
  uint64_t n160;
  uint64_t n161;
  uint64_t n162;
  uint64_t n163;
  uint64_t n164;
  uint64_t n165;
  uint64_t n166;
  uint64_t n167;
  uint64_t n168;
  uint64_t n169;
  uint64_t n170;
  uint64_t n171;
  uint64_t n172;
  uint64_t n173;
  uint64_t n174;
  uint64_t n175;
  uint64_t n176;
  uint64_t n177;
  uint64_t n178;
  uint64_t n179;
  uint64_t n180;
  uint64_t n181;
  uint64_t n182;
  uint64_t n183;
  uint64_t n184;
  uint64_t n185;
  uint64_t n186;
  uint64_t n187;
  uint64_t n188;
  uint64_t n189;
  uint64_t n190;
  uint64_t n191;
  uint64_t n192;
  uint64_t n193;
  uint64_t n194;
  uint64_t n195;
  uint64_t n196;
  uint64_t n197;
  uint64_t n198;
  uint64_t n199;
  uint64_t n200;
  uint64_t n201;
  uint64_t n202;
  uint64_t n203;
  uint64_t n204;
  uint64_t n205;
  uint64_t n206;
  uint64_t n207;
  uint64_t n208;
  uint64_t n209;
  uint64_t n210;
  uint64_t n211;
  uint64_t n212;
  uint64_t n213;
  uint64_t n214;
  uint64_t n215;
  uint64_t n216;
  uint64_t n217;
  uint64_t n218;
  uint64_t n219;
  uint64_t n220;
  uint64_t n221;
  uint64_t n222;
  uint64_t n223;
  uint64_t n224;
  uint64_t n225;
  uint64_t n226;
  uint64_t n227;
  uint64_t n228;
  uint64_t n229;
  uint64_t n230;
  uint64_t n231;
  uint64_t n232;
  uint64_t n233;
  uint64_t n234;
  uint64_t n235;
  uint64_t n236;
  uint64_t n237;
  uint64_t n238;
  uint64_t n239;
  uint64_t n240;
  uint64_t n241;
  uint64_t n242;
  uint64_t n243;
  uint64_t n244;
  uint64_t n245;
  uint64_t n246;
  uint64_t n247;
  uint64_t n248;
  uint64_t n249;
  uint64_t n250;
  uint64_t n251;
  uint64_t n252;
  uint64_t n253;
  uint64_t n254;
  uint64_t n255;
  uint64_t n256;
  uint64_t n257;
  uint64_t n258;
  uint64_t n259;
  uint64_t n260;
  uint64_t n261;
  uint64_t n262;
  uint64_t n263;
  uint64_t n264;
  uint64_t n265;
  uint64_t n266;
  uint64_t n267;
  uint64_t n268;
  uint64_t n269;
  uint64_t n270;
  uint64_t n271;
  uint64_t n272;
  uint64_t n273;
  uint64_t n274;
  uint64_t n275;
  uint64_t n276;
  uint64_t n277;
  uint64_t n278;
  uint64_t n279;
  uint64_t n280;
  uint64_t n281;
  uint64_t n282;
  uint64_t n283;
  uint64_t n284;
  uint64_t n285;
  uint64_t n286;
  uint64_t n287;
  uint64_t n288;
  uint64_t n289;
  uint64_t n290;
  uint64_t n291;
  uint64_t n292;
  uint64_t n293;
  uint64_t n294;
  uint64_t n295;
  uint64_t n296;
  uint64_t n297;
  uint64_t n298;
  uint64_t n299;
  uint64_t n300;
  uint64_t n301;
  uint64_t n302;
  uint64_t n303;
  uint64_t n304;
  uint64_t n305;
  uint64_t n306;
  uint64_t n307;
  uint64_t n308;
  uint64_t n309;
  uint64_t n310;
  uint64_t n311;
  uint64_t n312;
  uint64_t n313;
  uint64_t n314;
  uint64_t n315;
  uint64_t n316;
  uint64_t n317;
  uint64_t n318;
  uint64_t n319;
  uint64_t n320;
  uint64_t n321;
  uint64_t n322;
  uint64_t n323;
  uint64_t n324;
  uint64_t n325;
  uint64_t n326;
  uint64_t n327;
  uint64_t n328;
  uint64_t n329;
  uint64_t n330;
  uint64_t n331;
  uint64_t n332;
  uint64_t n333;
  uint64_t n334;
  uint64_t n335;
  uint64_t n336;
  uint64_t n337;
  uint64_t n338;
  uint64_t n339;
  uint64_t n340;
  uint64_t n341;
  uint64_t n342;
  uint64_t n343;
  uint64_t n344;
  uint64_t n345;
  uint64_t n346;
  uint64_t n347;
  uint64_t n348;
  uint64_t n349;
  uint64_t n350;
  uint64_t n351;
  uint64_t n352;
  uint64_t n353;
  uint64_t n354;
  uint64_t n355;
  uint64_t n356;
  uint64_t n357;
  uint64_t n358;
  uint64_t n359;
  uint64_t n360;
  uint64_t n361;
  uint64_t n362;
  uint64_t n363;
  uint64_t n364;
  uint64_t n365;
  uint64_t n366;
  uint64_t n367;
  uint64_t n368;
  uint64_t n369;
  uint64_t n370;
  uint64_t n371;
  uint64_t n372;
  uint64_t n373;
  uint64_t n374;
  uint64_t n375;
  uint64_t n376;
  uint64_t n377;
  uint64_t n378;
  uint64_t n379;
  uint64_t n380;
  uint64_t n381;
  uint64_t n382;
  uint64_t n383;
  uint64_t n384;
  uint64_t n385;
  uint64_t n386;
  uint64_t n387;
  uint64_t n388;
  uint64_t n389;
  uint64_t n390;
  uint64_t n391;
  uint64_t n392;
  uint64_t n393;
  uint64_t n394;
  uint64_t n395;
  uint64_t n396;
  uint64_t n397;
  uint64_t n398;
  uint64_t n399;
  uint64_t n400;
  uint64_t n401;
  uint64_t n402;
  uint64_t n403;
  uint64_t n404;
  uint64_t n405;
  uint64_t n406;
  uint64_t n407;
  uint64_t n408;
  uint64_t n409;
  uint64_t n410;
  uint64_t n411;
  uint64_t n412;
  uint64_t n413;
  uint64_t n414;
  uint64_t n415;
  uint64_t n416;
  uint64_t n417;
  uint64_t n418;
  uint64_t n419;
  uint64_t n420;
  uint64_t n421;
  uint64_t n422;
  uint64_t n423;
  uint64_t n424;
  uint64_t n425;
  uint64_t n426;
  uint64_t n427;
  uint64_t n428;
  uint64_t n429;
  uint64_t n430;
  uint64_t n431;
  uint64_t n432;
  uint64_t n433;
  uint64_t n434;
  uint64_t n435;
  uint64_t n436;
  uint64_t n437;
  uint64_t n438;
  uint64_t n439;
  uint64_t n440;
  uint64_t n441;
  uint64_t n442;
  uint64_t n443;
  uint64_t n444;
  uint64_t n445;
  uint64_t n446;
  uint64_t n447;
  uint64_t n448;
  uint64_t n449;
  uint64_t n450;
  uint64_t n451;
  uint64_t n452;
  uint64_t n453;
  uint64_t n454;
  uint64_t n455;
  uint64_t n456;
  uint64_t n457;
  uint64_t n458;
  uint64_t n459;
  uint64_t n460;
  uint64_t n461;
  uint64_t n462;
  uint64_t n463;
// n205 = x[15] & y[15];
multiply_64b_using_log_table(&x[15], &y[15], &n205);
//n204 = x[14] & y[14];
multiply_64b_using_log_table(&x[14], &y[14], &n204);
n209 = n205 ^ n204;
//n197 = x[13] & y[13];
multiply_64b_using_log_table(&x[13], &y[13], &n197);
//n196 = x[12] & y[12];
multiply_64b_using_log_table(&x[12], &y[12], &n196);
n201 = n197 ^ n196;
n225 = n209 ^ n201;
//n170 = x[11] & y[11];
multiply_64b_using_log_table(&x[11], &y[11], &n170);
//n169 = x[10] & y[10];
multiply_64b_using_log_table(&x[10], &y[10], &n169);
n174 = n170 ^ n169;
//n162 = x[9] & y[9];
multiply_64b_using_log_table(&x[9], &y[9], &n162);
//n161 = x[8] & y[8];
multiply_64b_using_log_table(&x[8], &y[8], &n161);
n166 = n162 ^ n161;
n190 = n174 ^ n166;
n277 = n225 ^ n190;
//n77 = x[7] & y[7];
multiply_64b_using_log_table(&x[7], &y[7], &n77);
//n76 = x[6] & y[6];
multiply_64b_using_log_table(&x[6], &y[6], &n76);
n81 = n77 ^ n76;
//n69 = x[5] & y[5];
multiply_64b_using_log_table(&x[5], &y[5], &n69);
//n68 = x[4] & y[4];
multiply_64b_using_log_table(&x[4], &y[4], &n68);
n73 = n69 ^ n68;
n97 = n81 ^ n73;
//n42 = x[3] & y[3];
multiply_64b_using_log_table(&x[3], &y[3], &n42);
//n41 = x[2] & y[2];
multiply_64b_using_log_table(&x[2], &y[2], &n41);
n46 = n42 ^ n41;
//n34 = x[1] & y[1];
multiply_64b_using_log_table(&x[1], &y[1], &n34);
//n33 = x[0] & y[0];
multiply_64b_using_log_table(&x[0], &y[0], &n33);
n38 = n34 ^ n33;
n62 = n46 ^ n38;
n149 = n97 ^ n62;
n440 = n277 ^ n149;
n206 = x[15] ^ x[14];
n207 = y[15] ^ y[14];
//n208 = n206 & n207;
multiply_64b_using_log_table(&n206, &n207, &n208);
n210 = n209 ^ n208;
n211 = n210 ^ n205;
n198 = x[13] ^ x[12];
n199 = y[13] ^ y[12];
//n200 = n198 & n199;
multiply_64b_using_log_table(&n198, &n199, &n200);
n202 = n201 ^ n200;
n203 = n202 ^ n197;
n226 = n211 ^ n203;
n171 = x[11] ^ x[10];
n172 = y[11] ^ y[10];
//n173 = n171 & n172;
multiply_64b_using_log_table(&n171, &n172, &n173);
n175 = n174 ^ n173;
n176 = n175 ^ n170;
n163 = x[9] ^ x[8];
n164 = y[9] ^ y[8];
//n165 = n163 & n164;
multiply_64b_using_log_table(&n163, &n164, &n165);
n167 = n166 ^ n165;
n168 = n167 ^ n162;
n191 = n176 ^ n168;
n278 = n226 ^ n191;
n78 = x[7] ^ x[6];
n79 = y[7] ^ y[6];
//n80 = n78 & n79;
multiply_64b_using_log_table(&n78, &n79, &n80);
n82 = n81 ^ n80;
n83 = n82 ^ n77;
n70 = x[5] ^ x[4];
n71 = y[5] ^ y[4];
//n72 = n70 & n71;
multiply_64b_using_log_table(&n70, &n71, &n72);
n74 = n73 ^ n72;
n75 = n74 ^ n69;
n98 = n83 ^ n75;
n43 = x[3] ^ x[2];
n44 = y[3] ^ y[2];
//n45 = n43 & n44;
multiply_64b_using_log_table(&n43, &n44, &n45);
n47 = n46 ^ n45;
n48 = n47 ^ n42;
n35 = x[1] ^ x[0];
n36 = y[1] ^ y[0];
//n37 = n35 & n36;
multiply_64b_using_log_table(&n35, &n36, &n37);
n39 = n38 ^ n37;
n40 = n39 ^ n34;
n63 = n48 ^ n40;
n150 = n98 ^ n63;
n441 = n278 ^ n150;
n214 = x[15] ^ x[13];
n215 = y[15] ^ y[13];
//n218 = n214 & n215;
multiply_64b_using_log_table(&n214, &n215, &n218);
n212 = x[14] ^ x[12];
n213 = y[14] ^ y[12];
//n217 = n212 & n213;
multiply_64b_using_log_table(&n212, &n213, &n217);
n222 = n218 ^ n217;
n227 = n225 ^ n222;
n228 = n227 ^ n211;
n179 = x[11] ^ x[9];
n180 = y[11] ^ y[9];
//n183 = n179 & n180;
multiply_64b_using_log_table(&n179, &n180, &n183);
n177 = x[10] ^ x[8];
n178 = y[10] ^ y[8];
//n182 = n177 & n178;
multiply_64b_using_log_table(&n177, &n178, &n182);
n187 = n183 ^ n182;
n192 = n190 ^ n187;
n193 = n192 ^ n176;
n279 = n228 ^ n193;
n86 = x[7] ^ x[5];
n87 = y[7] ^ y[5];
//n90 = n86 & n87;
multiply_64b_using_log_table(&n86, &n87, &n90);
n84 = x[6] ^ x[4];
n85 = y[6] ^ y[4];
//n89 = n84 & n85;
multiply_64b_using_log_table(&n84, &n85, &n89);
n94 = n90 ^ n89;
n99 = n97 ^ n94;
n100 = n99 ^ n83;
n51 = x[3] ^ x[1];
n52 = y[3] ^ y[1];
//n55 = n51 & n52;
multiply_64b_using_log_table(&n51, &n52, &n55);
n49 = x[2] ^ x[0];
n50 = y[2] ^ y[0];
//n54 = n49 & n50;
multiply_64b_using_log_table(&n49, &n50, &n54);
n59 = n55 ^ n54;
n64 = n62 ^ n59;
n65 = n64 ^ n48;
n151 = n100 ^ n65;
n442 = n279 ^ n151;
n219 = n214 ^ n212;
n220 = n215 ^ n213;
//n221 = n219 & n220;
multiply_64b_using_log_table(&n219, &n220, &n221);
n223 = n222 ^ n221;
n224 = n223 ^ n218;
n229 = n226 ^ n224;
n216 = n211 ^ n209;
n230 = n229 ^ n216;
n184 = n179 ^ n177;
n185 = n180 ^ n178;
//n186 = n184 & n185;
multiply_64b_using_log_table(&n184, &n185, &n186);
n188 = n187 ^ n186;
n189 = n188 ^ n183;
n194 = n191 ^ n189;
n181 = n176 ^ n174;
n195 = n194 ^ n181;
n280 = n230 ^ n195;
n91 = n86 ^ n84;
n92 = n87 ^ n85;
//n93 = n91 & n92;
multiply_64b_using_log_table(&n91, &n92, &n93);
n95 = n94 ^ n93;
n96 = n95 ^ n90;
n101 = n98 ^ n96;
n88 = n83 ^ n81;
n102 = n101 ^ n88;
n56 = n51 ^ n49;
n57 = n52 ^ n50;
//n58 = n56 & n57;
multiply_64b_using_log_table(&n56, &n57, &n58);
n60 = n59 ^ n58;
n61 = n60 ^ n55;
n66 = n63 ^ n61;
n53 = n48 ^ n46;
n67 = n66 ^ n53;
n152 = n102 ^ n67;
n443 = n280 ^ n152;
n237 = x[15] ^ x[11];
n238 = y[15] ^ y[11];
//n251 = n237 & n238;
multiply_64b_using_log_table(&n237, &n238, &n251);
n235 = x[14] ^ x[10];
n236 = y[14] ^ y[10];
//n250 = n235 & n236;
multiply_64b_using_log_table(&n235, &n236, &n250);
n255 = n251 ^ n250;
n233 = x[13] ^ x[9];
n234 = y[13] ^ y[9];
//n243 = n233 & n234;
multiply_64b_using_log_table(&n233, &n234, &n243);
n231 = x[12] ^ x[8];
n232 = y[12] ^ y[8];
//n242 = n231 & n232;
multiply_64b_using_log_table(&n231, &n232, &n242);
n247 = n243 ^ n242;
n271 = n255 ^ n247;
n281 = n277 ^ n271;
n282 = n281 ^ n228;
n109 = x[7] ^ x[3];
n110 = y[7] ^ y[3];
//n123 = n109 & n110;
multiply_64b_using_log_table(&n109, &n110, &n123);
n107 = x[6] ^ x[2];
n108 = y[6] ^ y[2];
//n122 = n107 & n108;
multiply_64b_using_log_table(&n107, &n108, &n122);
n127 = n123 ^ n122;
n105 = x[5] ^ x[1];
n106 = y[5] ^ y[1];
//n115 = n105 & n106;
multiply_64b_using_log_table(&n105, &n106, &n115);
n103 = x[4] ^ x[0];
n104 = y[4] ^ y[0];
//n114 = n103 & n104;
multiply_64b_using_log_table(&n103, &n104, &n114);
n119 = n115 ^ n114;
n143 = n127 ^ n119;
n153 = n149 ^ n143;
n154 = n153 ^ n100;
n444 = n282 ^ n154;
n252 = n237 ^ n235;
n253 = n238 ^ n236;
//n254 = n252 & n253;
multiply_64b_using_log_table(&n252, &n253, &n254);
n256 = n255 ^ n254;
n257 = n256 ^ n251;
n244 = n233 ^ n231;
n245 = n234 ^ n232;
//n246 = n244 & n245;
multiply_64b_using_log_table(&n244, &n245, &n246);
n248 = n247 ^ n246;
n249 = n248 ^ n243;
n272 = n257 ^ n249;
n283 = n278 ^ n272;
n284 = n283 ^ n230;
n124 = n109 ^ n107;
n125 = n110 ^ n108;
//n126 = n124 & n125;
multiply_64b_using_log_table(&n124, &n125, &n126);
n128 = n127 ^ n126;
n129 = n128 ^ n123;
n116 = n105 ^ n103;
n117 = n106 ^ n104;
//n118 = n116 & n117;
multiply_64b_using_log_table(&n116, &n117, &n118);
n120 = n119 ^ n118;
n121 = n120 ^ n115;
n144 = n129 ^ n121;
n155 = n150 ^ n144;
n156 = n155 ^ n102;
n445 = n284 ^ n156;
n260 = n237 ^ n233;
n261 = n238 ^ n234;
//n264 = n260 & n261;
multiply_64b_using_log_table(&n260, &n261, &n264);
n258 = n235 ^ n231;
n259 = n236 ^ n232;
//n263 = n258 & n259;
multiply_64b_using_log_table(&n258, &n259, &n263);
n268 = n264 ^ n263;
n273 = n271 ^ n268;
n274 = n273 ^ n257;
n285 = n279 ^ n274;
n240 = n230 ^ n225;
n286 = n285 ^ n240;
n132 = n109 ^ n105;
n133 = n110 ^ n106;
//n136 = n132 & n133;
multiply_64b_using_log_table(&n132, &n133, &n136);
n130 = n107 ^ n103;
n131 = n108 ^ n104;
//n135 = n130 & n131;
multiply_64b_using_log_table(&n130, &n131, &n135);
n140 = n136 ^ n135;
n145 = n143 ^ n140;
n146 = n145 ^ n129;
n157 = n151 ^ n146;
n112 = n102 ^ n97;
n158 = n157 ^ n112;
n446 = n286 ^ n158;
n265 = n260 ^ n258;
n266 = n261 ^ n259;
//n267 = n265 & n266;
multiply_64b_using_log_table(&n265, &n266, &n267);
n269 = n268 ^ n267;
n270 = n269 ^ n264;
n275 = n272 ^ n270;
n262 = n257 ^ n255;
n276 = n275 ^ n262;
n287 = n280 ^ n276;
n239 = n230 ^ n228;
n241 = n239 ^ n226;
n288 = n287 ^ n241;
n137 = n132 ^ n130;
n138 = n133 ^ n131;
//n139 = n137 & n138;
multiply_64b_using_log_table(&n137, &n138, &n139);
n141 = n140 ^ n139;
n142 = n141 ^ n136;
n147 = n144 ^ n142;
n134 = n129 ^ n127;
n148 = n147 ^ n134;
n159 = n152 ^ n148;
n111 = n102 ^ n100;
n113 = n111 ^ n98;
n160 = n159 ^ n113;
n447 = n288 ^ n160;
n303 = x[15] ^ x[7];
n304 = y[15] ^ y[7];
//n356 = n303 & n304;
multiply_64b_using_log_table(&n303, &n304, &n356);
n301 = x[14] ^ x[6];
n302 = y[14] ^ y[6];
//n355 = n301 & n302;
multiply_64b_using_log_table(&n301, &n302, &n355);
n360 = n356 ^ n355;
n299 = x[13] ^ x[5];
n300 = y[13] ^ y[5];
//n348 = n299 & n300;
multiply_64b_using_log_table(&n299, &n300, &n348);
n297 = x[12] ^ x[4];
n298 = y[12] ^ y[4];
//n347 = n297 & n298;
multiply_64b_using_log_table(&n297, &n298, &n347);
n352 = n348 ^ n347;
n376 = n360 ^ n352;
n295 = x[11] ^ x[3];
n296 = y[11] ^ y[3];
//n321 = n295 & n296;
multiply_64b_using_log_table(&n295, &n296, &n321);
n293 = x[10] ^ x[2];
n294 = y[10] ^ y[2];
//n320 = n293 & n294;
multiply_64b_using_log_table(&n293, &n294, &n320);
n325 = n321 ^ n320;
n291 = x[9] ^ x[1];
n292 = y[9] ^ y[1];
//n313 = n291 & n292;
multiply_64b_using_log_table(&n291, &n292, &n313);
n289 = x[8] ^ x[0];
n290 = y[8] ^ y[0];
//n312 = n289 & n290;
multiply_64b_using_log_table(&n289, &n290, &n312);
n317 = n313 ^ n312;
n341 = n325 ^ n317;
n428 = n376 ^ n341;
n448 = n440 ^ n428;
n449 = n448 ^ n282;
n357 = n303 ^ n301;
n358 = n304 ^ n302;
//n359 = n357 & n358;
multiply_64b_using_log_table(&n357, &n358, &n359);
n361 = n360 ^ n359;
n362 = n361 ^ n356;
n349 = n299 ^ n297;
n350 = n300 ^ n298;
//n351 = n349 & n350;
multiply_64b_using_log_table(&n349, &n350, &n351);
n353 = n352 ^ n351;
n354 = n353 ^ n348;
n377 = n362 ^ n354;
n322 = n295 ^ n293;
n323 = n296 ^ n294;
//n324 = n322 & n323;
multiply_64b_using_log_table(&n322, &n323, &n324);
n326 = n325 ^ n324;
n327 = n326 ^ n321;
n314 = n291 ^ n289;
n315 = n292 ^ n290;
//n316 = n314 & n315;
multiply_64b_using_log_table(&n314, &n315, &n316);
n318 = n317 ^ n316;
n319 = n318 ^ n313;
n342 = n327 ^ n319;
n429 = n377 ^ n342;
n450 = n441 ^ n429;
n451 = n450 ^ n284;
n365 = n303 ^ n299;
n366 = n304 ^ n300;
//n369 = n365 & n366;
multiply_64b_using_log_table(&n365, &n366, &n369);
n363 = n301 ^ n297;
n364 = n302 ^ n298;
//n368 = n363 & n364;
multiply_64b_using_log_table(&n363, &n364, &n368);
n373 = n369 ^ n368;
n378 = n376 ^ n373;
n379 = n378 ^ n362;
n330 = n295 ^ n291;
n331 = n296 ^ n292;
//n334 = n330 & n331;
multiply_64b_using_log_table(&n330, &n331, &n334);
n328 = n293 ^ n289;
n329 = n294 ^ n290;
//n333 = n328 & n329;
multiply_64b_using_log_table(&n328, &n329, &n333);
n338 = n334 ^ n333;
n343 = n341 ^ n338;
n344 = n343 ^ n327;
n430 = n379 ^ n344;
n452 = n442 ^ n430;
n453 = n452 ^ n286;
n370 = n365 ^ n363;
n371 = n366 ^ n364;
//n372 = n370 & n371;
multiply_64b_using_log_table(&n370, &n371, &n372);
n374 = n373 ^ n372;
n375 = n374 ^ n369;
n380 = n377 ^ n375;
n367 = n362 ^ n360;
n381 = n380 ^ n367;
n335 = n330 ^ n328;
n336 = n331 ^ n329;
//n337 = n335 & n336;
multiply_64b_using_log_table(&n335, &n336, &n337);
n339 = n338 ^ n337;
n340 = n339 ^ n334;
n345 = n342 ^ n340;
n332 = n327 ^ n325;
n346 = n345 ^ n332;
n431 = n381 ^ n346;
n454 = n443 ^ n431;
n455 = n454 ^ n288;
n388 = n303 ^ n295;
n389 = n304 ^ n296;
//n402 = n388 & n389;
multiply_64b_using_log_table(&n388, &n389, &n402);
n386 = n301 ^ n293;
n387 = n302 ^ n294;
//n401 = n386 & n387;
multiply_64b_using_log_table(&n386, &n387, &n401);
n406 = n402 ^ n401;
n384 = n299 ^ n291;
n385 = n300 ^ n292;
//n394 = n384 & n385;
multiply_64b_using_log_table(&n384, &n385, &n394);
n382 = n297 ^ n289;
n383 = n298 ^ n290;
//n393 = n382 & n383;
multiply_64b_using_log_table(&n382, &n383, &n393);
n398 = n394 ^ n393;
n422 = n406 ^ n398;
n432 = n428 ^ n422;
n433 = n432 ^ n379;
n456 = n444 ^ n433;
n308 = n286 ^ n277;
n457 = n456 ^ n308;
n403 = n388 ^ n386;
n404 = n389 ^ n387;
//n405 = n403 & n404;
multiply_64b_using_log_table(&n403, &n404, &n405);
n407 = n406 ^ n405;
n408 = n407 ^ n402;
n395 = n384 ^ n382;
n396 = n385 ^ n383;
//n397 = n395 & n396;
multiply_64b_using_log_table(&n395, &n396, &n397);
n399 = n398 ^ n397;
n400 = n399 ^ n394;
n423 = n408 ^ n400;
n434 = n429 ^ n423;
n435 = n434 ^ n381;
n458 = n445 ^ n435;
n309 = n288 ^ n278;
n459 = n458 ^ n309;
n411 = n388 ^ n384;
n412 = n389 ^ n385;
//n415 = n411 & n412;
multiply_64b_using_log_table(&n411, &n412, &n415);
n409 = n386 ^ n382;
n410 = n387 ^ n383;
//n414 = n409 & n410;
multiply_64b_using_log_table(&n409, &n410, &n414);
n419 = n415 ^ n414;
n424 = n422 ^ n419;
n425 = n424 ^ n408;
n436 = n430 ^ n425;
n391 = n381 ^ n376;
n437 = n436 ^ n391;
n460 = n446 ^ n437;
n306 = n288 ^ n282;
n310 = n306 ^ n279;
n461 = n460 ^ n310;
n416 = n411 ^ n409;
n417 = n412 ^ n410;
//n418 = n416 & n417;
multiply_64b_using_log_table(&n416, &n417, &n418);
n420 = n419 ^ n418;
n421 = n420 ^ n415;
n426 = n423 ^ n421;
n413 = n408 ^ n406;
n427 = n426 ^ n413;
n438 = n431 ^ n427;
n390 = n381 ^ n379;
n392 = n390 ^ n377;
n439 = n438 ^ n392;
n462 = n447 ^ n439;
n305 = n288 ^ n286;
n307 = n305 ^ n284;
n311 = n307 ^ n280;
n463 = n462 ^ n311;
  z[0] = n440;
  z[1] = n441;
  z[2] = n442;
  z[3] = n443;
  z[4] = n444;
  z[5] = n445;
  z[6] = n446;
  z[7] = n447;
  z[8] = n449;
  z[9] = n451;
  z[10] = n453;
  z[11] = n455;
  z[12] = n457;
  z[13] = n459;
  z[14] = n461;
  z[15] = n463;
}
